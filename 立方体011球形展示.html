<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<style type="text/css">
			#prv {
				width: 600px;
				height: 600px;
				transform-style: preserve-3d;
				perspective: 1200px;
				transform: translate(150px, 100px);
			}

			#clube {
				width: 600px;
				height: 600px;
				transform-style: preserve-3d;
				perspective: auto;
				transition: all 5s linear;
				transform-origin: 300px 0;
				animation: am01 15s linear infinite;
				position: relative;
			}

			#clube:hover {
				transform: rotateX(0) rotateY(135deg) rotateZ(0);
			}

			.circle {
				width: 50px;
				height: 50px;
				background: rgba(255, 0, 0, 0.8);
				position: absolute;
				left: 275px;
				top: 275px;
				transform-origin: 25px 25px;
				border-radius: 25px;
				background: url(aa.jpg) 0 0/50px 50px;
				transition: all 0.5s ease;
				/* box-shadow: 0 0 1px 1px #000; */
			}

			@keyframes am01 {
				0% {
					transform: rotateX(0) rotateY(0) rotateZ(0);
				}

				/*
				50% {
					transform: rotateX(-45deg) rotateY(180deg) rotateZ(0);
				}
*/
				100% {
					transform: rotateX(0) rotateY(360deg) rotateZ(0);
				}
			}

			#prv {
				/* background: rgba(255,255,255,0.3); */
				/* border-radius: 100%; */
			}
		</style>
	</head>
	<body>
		<button id='btn' onclick="trans()">变换</button>
		<div id="prv">
			<div id="clube">
			</div>
		</div>
		<script type="text/javascript">
			var clube = document.querySelector('#clube')
			let eles = []
			for (let i = 0; i < 500; i++) {
				let ele = document.createElement('div')
				ele.id = "c-" + i
				ele.className = 'circle'
				ele.style.width = 0
				ele.style.height = 0
				clube.appendChild(ele)
				eles.push(ele)
			}
			var photos = []
			for (let i = 0; i < 380; i++) {
				photos.push("images/" + (i + 1) + ".jpg")
			}

			function trans_none() {
				eles.forEach(k => {
					k.style.transform = 'translate3d(0,0,0)'
					k.style.width = 0
					k.style.height = 0
				})
			}

			function trans_a() { //立方体
				photos.sort(() => Math.random() - 0.5)
				for (var k = 0; k < 7; k++) {
					for (var j = 0; j < 7; j++) {
						for (let i = 0; i < 7; i++) {
							let ele = eles[k * 7 * 7 + j * 7 + i]
							ele.style.width = '50px'
							ele.style.height = '50px'
							ele.style.backgroundImage = 'url(' + photos[k * 7 * 7 + j * 7 + i] + ')'
							ele.style.transform = 'rotatey(90deg) translatex(' + 90 * (i - 3) + 'px) translatey(' + (90 * (j - 3)) + 'px) translatez(' + (90 * (k - 3)) + 'px)'
						}
					}
				}
			}

			function trans_b() { //圆柱形
				photos.sort(() => Math.random() - 0.5)
				for (var j = 0; j < 9; j++) {
					for (let i = 0; i < 30; i++) {
						let ele = eles[j * 30 + i]
						ele.style.width = '50px'
						ele.style.height = '50px'
						ele.style.backgroundImage = 'url(' + photos[j * 30 + i] + ')'
						ele.style.transform = 'rotatey(' + (i * 12) + 'deg) translatez(350px) translatey(' + (65 * (j - 4)) + 'px)'
					}
				}
			}

			function trans_c() { //球型
				let arr = [30, 30, 30, 24, 20, 18, 10, 4],
					n = 0
				photos.sort(() => Math.random() - 0.5)
				for (let j = 0; j < 15; j++) {
					let t = arr[Math.abs(j - 7)]
					for (let i = 0; i < t; i++) {
						let ele = eles[n++]
						ele.style.width = '50px'
						ele.style.height = '50px'
						ele.style.backgroundImage = 'url(' + photos[n] + ')'
						ele.style.transform = 'rotatey(' + (i * 360 / t) + 'deg) rotatex(' + (12 * (j - 7)) + 'deg) translatez(350px) '
					}
				}
			}

			function trans_d() { //平面矩形
				for (let i = 0; i < 13; i++) {
					for (let j = 0; j < 13; j++) {
						let ele = eles[i * 13 + j]
						ele.style.width = '50px'
						ele.style.height = '50px'
						ele.style.backgroundImage = 'url(' + photos[i * 13 + j] + ')'
						ele.style.transform = 'translatex(' + (60 * (i - 6)) + 'px) translatey(' + (60 * (j - 6)) + 'px)'
					}
				}
			}

			function trans_e() { //平面六边形
				let n = 0
				let arr = [3, 5, 7, 7, 7, 5, 3]
				for (let i = 0; i < 7; i++) {
					for (let j = 0; j < arr[i]; j++) {
						let ele = eles[n++]
						ele.style.width = '50px'
						ele.style.height = '50px'
						ele.style.backgroundImage = 'url(' + photos[n] + ')'
						ele.style.transform = 'translatex(' + (60 * (j - parseInt(arr[i] / 2))) + 'px) translatey(' + (60 * (i - 3)) + 'px) translatez(300px)'
						console.log(parseInt(arr[i] / 2))
					}
				}
				for (let i = 0; i < 7; i++) {
					for (let j = 0; j < arr[i]; j++) {
						let ele = eles[n++]
						ele.style.width = '50px'
						ele.style.height = '50px'
						ele.style.backgroundImage = 'url(' + photos[n] + ')'
						ele.style.transform = 'rotatey() translatex(' + (60 * (j - parseInt(arr[i] / 2))) + 'px) translatey(' + (60 * (i - 3)) + 'px) translatez(300px)'
						console.log(parseInt(arr[i] / 2))
					}
				}
			}

			function trans() {
				clearInterval(timer)
				trans_none()
				trans_e()
			}
			trans_c()
			var flag = 0
			/*		*/
			var timer = setInterval(anima, 10000)

			function anima() {
				flag = flag % 4
				trans_none()
				if (flag == 0) {
					trans_b()
				} else if (flag == 1) {
					trans_a()
				} else if (flag == 2) {
					trans_c()
				} else {
					trans_d()
				}
				flag++
			}
		</script>
	</body>
</html>